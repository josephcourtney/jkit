hbond cutoff 0.6
charged cutoff 0.8

annotate atoms
    identify aromatic rings and annotate atoms with group id
        add center atom and two flanking atoms to define perpindicular axis
        set central pseudoatom as an acceptor
    if H is bonded to NOS
        donor    
    water o         acceptor | donor
    water h         donor
    if element in [N, O, S, H], atom in [protein, nucleic acid, or water]
        atom element in NOS
            set acceptor # default
        if atom in DonorAcceptorAtomTbl
            set acceptor/donor from table
    if atom in protein
        if atom name in AmbigChargedAtomsList
            terminal N, H: positive
            terminal carboxyl O: negative
        if atom name in AlwaysChargedAtomsList
            if atom name is H
                set positive
            if atom is N:
                set positive
            if atom is O:
                set negative
            if atom is S:
                set negative
            if atom is P:
                set negative
            if atom is F:
                set negative
                set hbond acceptor
            if atom is Cl:
                set negative
                set hbond acceptor
            if atom is Br:
                set negative
                set hbond acceptor
            if atom is I:
                set negative
                set hbond acceptor
        if atom name in ChargedAAList:
            set charge from ChargedAAAtomsTbl

psi-phi group
   A         X
    \      :
     C = O 
    /
   B

   psi: out of plane angle to X (actually 90 - angle)
   phi: in plane deviation from C=O bond axis
theta-tau group
    theta: D-H-A angle
    nu: A-O-H angle
    tau: angle from newman projection

type 1:
A
  \
   X-O ~ Z
  /
A
X: (C, S, P)
plane: O-X-(A,A)
psi: X-O~Z out of plane - 90
phi: X-O~Z in plane

type 2:
X
  \
   Y ~ Z
  /
X
Y: (N, O, S)
X: (C, N, O, S, P, H)
plane: X-Y-X
psi: (X,X)-Y~Z out of plane - 90
phi: (X,X)-Y~Z in plane



type 3:
X
  \
X - N
  /
X
X: (C, N, O, S, P, H)


anti r2po2





ramachandran categorization
if (value >= 0.02):
    return RAMALYZE_FAVORED
if (resType == RAMA_GENERAL):
    if (value >= 0.0005):
    return RAMALYZE_ALLOWED
    else:
    return RAMALYZE_OUTLIER
elif (resType == RAMA_CISPRO):
    if (value >=0.0020):
    return RAMALYZE_ALLOWED
    else:
    return RAMALYZE_OUTLIER
else:
    if (value >= 0.0010):
    return RAMALYZE_ALLOWED
    else:
    return RAMALYZE_OUTLIER


favored:    value >= 0.02
allowed:    value >= 0.0005
